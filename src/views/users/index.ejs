<div class="grid-2cols gap-lg align-start">
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Daftar Pengguna</h3>
    </div>
    <div class="table-wrapper">
      <table class="table">
        <thead>
          <tr>
            <th>Nama</th>
            <th>Email</th>
            <th>Username</th>
            <th>Phone</th>
            <th>Organisasi</th>
            <th>Role</th>
            <th>Status</th>
            <th>Email Verified</th>
            <th>Dibuat</th>
            <th>Login Terakhir</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          <% if (!users || !users.length) { %>
            <tr>
              <td colspan="11" class="text-center">Belum ada pengguna</td>
            </tr>
            <% } else { %>
              <% users.forEach(function(u) { %>
                <tr>
                  <td>
                    <%= u.full_name %>
                  </td>
                  <td>
                    <%= u.email %>
                  </td>
                  <td>
                    <%= u.username %>
                  </td>
                  <td>
                    <%= u.phone_number || '-' %>
                  </td>
                  <td>
                    <%= u.organization || '-' %>
                  </td>
                  <td><span class="badge badge-info">
                      <%= u.role %>
                    </span></td>
                  <td><span class="badge <%= u.is_active ? '' : 'badge-danger' %>">
                      <%= u.is_active ? 'Aktif' : 'Nonaktif' %>
                    </span></td>
                  <td><span class="badge <%= u.email_verified ? '' : 'badge-warning' %>">
                      <%= u.email_verified ? 'Verified' : 'Belum' %>
                    </span></td>
                  <td>
                    <%= u.created_at ? new Date(u.created_at).toLocaleDateString('id-ID') : '-' %>
                  </td>
                  <td>
                    <%= u.last_login ? new Date(u.last_login).toLocaleString('id-ID') : '-' %>
                  </td>
                  <td style="white-space: nowrap;">
                    <a href="/users/<%= u.id %>/edit" class="btn-action btn-edit" title="Edit">‚úèÔ∏è</a>
                    <form method="post" action="/users/<%= u.id %>/delete" style="display:inline;"
                      onsubmit="return confirm('Yakin hapus pengguna ini?')">
                      <button type="submit" class="btn-action btn-delete" title="Hapus">üóëÔ∏è</button>
                    </form>
                  </td>
                </tr>
                <% }) %>
                  <% } %>
        </tbody>
      </table>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Tambah Pengguna</h3>
    </div>
    <form method="post" action="/users" class="form-vertical">
      <label>
        <span>Nama Lengkap</span>
        <input type="text" name="full_name" required />
      </label>
      <label>
        <span>Email</span>
        <input type="email" name="email" required />
      </label>
      <label>
        <span>Username</span>
        <input type="text" name="username" required />
      </label>
      <label>
        <span>Password</span>
        <input type="password" name="password" required />
      </label>
      <label>
        <span>Nomor Telepon</span>
        <input type="tel" name="phone_number" placeholder="Opsional" />
      </label>
      <label>
        <span>Organisasi</span>
        <input type="text" name="organization" placeholder="Opsional" />
      </label>
      <label>
        <span>Role</span>
        <select name="role">
          <% if (typeof roles !=='undefined' && roles.length) { %>
            <% roles.forEach(function(r) { %>
              <option value="<%= r.role_name %>" <%=r.role_name==='OPERATOR' ? 'selected' : '' %>><%= r.role_name %>
              </option>
              <% }) %>
                <% } else { %>
                  <option value="OPERATOR" selected>Operator</option>
                  <% } %>
        </select>
      </label>
      <button type="submit" class="btn-primary w-full">Simpan</button>
    </form>
  </div>
</div>